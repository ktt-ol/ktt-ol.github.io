<!doctype html><html prefix="og: https://ogp.me/ns#" data-bs-theme=dark lang=de><head><meta charset=utf-8><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content="Kreativität trifft Technik e.V." property=og:site_name><meta content=de_DE property=og:locale><meta content=de_DE property=og:locale:alternate><meta content=en_US property=og:locale:alternate><meta content=https://ktt-ol.github.io/blog/2016/acs property=og:url><meta content=sre name=author><meta content=article property=og:type><script type=application/ld+json>
        {
            "@context": "https://schema.org/",
            "@type": "ImageObject",
            "contentUrl": "https://ktt-ol.github.io/media/blog/2016/acs/hacs-thumb.svg",
        "license": "https://creativecommons.org/licenses/by-sa/4.0/",
        "acquireLicensePage": "https://creativecommons.org/licenses/by-sa/4.0/",
        "creditText": "Hackspace Access Control System",
        "creator": {
            "@type": "Person",
            "name": "sre",
            "url": "https://mainframe.io"
        },
        "copyrightNotice": "sre"
    }
    </script><meta content=https://ktt-ol.github.io/media/blog/2016/acs/hacs-thumb.svg property=og:image><meta content=https://ktt-ol.github.io/media/blog/2016/acs/hacs-thumb.svg property=og:image:secure_url><meta content=image/svg property=og:image:type><meta content=205 property=og:image:width><meta content=180 property=og:image:height><meta content="Hackspace Access Control System" property=og:image:alt><meta content=summary_large_image property=twitter:card><meta content=sre property=twitter:site><meta content=sre property=twitter:creator><meta content=https://ktt-ol.github.io/media/blog/2016/acs/hacs-thumb.svg property=twitter:image><meta content="Hackspace Access Control System" property=twitter:title><meta content=205 property=twitter:image:width><meta content=image/svg property=twitter:image:type><meta content=180 property=twitter:image:height><title>Hackspace Access Control System | Kreativität trifft Technik e.V.</title><meta content="Hackspace Access Control System | Kreativität trifft Technik e.V." property=og:title><meta content="Website des Kreativität trifft Technik e.V." property=og:description><meta content="Website des Kreativität trifft Technik e.V." name=description><script type=application/ld+json>
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "image": "https://www.ktt-ol.de/media/img/logo-ktt.png",
            "url": "https://www.ktt-ol.de",
            "sameAs": [
                "https://mainframe.io",
                "https://kreativitaet-trifft-technik.de",
                "https://kreativität-trifft-technik.de"
            ],
            "logo": "https://www.ktt-ol.de/media/img/logo-ktt.png",
            "name": "Kreativität trifft Technik e.V.",
            "description": "Kreativität trifft Technik e.V. - Hackspace Oldenburg",
            "email": "vorstand@ktt-ol.de",
            "telephone": "+49441-559 700 32",
            "address": {
                "@type": "PostalAddress",
                "streetAddress": "Bahnhofsplatz 10",
                "addressLocality": "Oldenburg",
                "addressCountry": "DE",
                "addressRegion": "Innenstadt",
                "postalCode": "26122"
            },
            "vatID": "",
            "iso6523Code": ""
        }
    </script><link href=https://ktt-ol.github.io/css/site.css rel=stylesheet><link href=https://ktt-ol.github.io/rss.xml rel=alternate title=RSS type=application/rss+xml><link href=https://ktt-ol.github.io/atom.xml rel=alternate title=RSS type=application/rss+xml><body class="vh-100 m-0 p-0"><div class="container-lg h-100 px-lg-0 px-4 d-flex flex-column text-white"><header class="row my-2" id=navbar><div class=col><nav class="navbar navbar-expand-lg bg-body-secondary rounded"><div class=container-fluid><a class=navbar-brand href=https://ktt-ol.github.io/ style=padding-top:10px;padding-bottom:10px> <img alt="Mainframe Logo" id=img-logo-mainframe src=https://ktt-ol.github.io/media/img/logo-mainframe.svg style=height:28px> </a><button aria-label="Toggle navigation" aria-expanded=false class=navbar-toggler data-bs-target=#navbarNav data-bs-toggle=collapse type=button><span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarNav><ul class="navbar-nav me-auto"><li class="nav-item dropdown"><a class="text-white text-decoration-none d-block py-2 pe-3 dropdown-toggle" aria-expanded=false data-bs-toggle=dropdown href=# role=button> Der Verein </a> <ul class=dropdown-menu><li><a class=dropdown-item href=/about/about/> Über uns </a><li><a class=dropdown-item href=/about/membership/> Mitgliedschaft </a><li><a class=dropdown-item href=/about/support/> Unterstützen </a><li><a class=dropdown-item href=/about/communication/> Kommunikation </a><li><a class=dropdown-item href=/about/in-the-press/> Pressespiegel </a><li><a class=dropdown-item href=/about/history/> Vereinsgeschichte </a></ul><li class="nav-item dropdown"><a class="text-white text-decoration-none d-block py-2 pe-3 dropdown-toggle" aria-expanded=false data-bs-toggle=dropdown href=# role=button> Räume </a> <ul class=dropdown-menu><li><a class=dropdown-item href=/spacewalk/overview/> Übersicht </a><li><a class=dropdown-item href=/spacewalk/lasercutter/> Lasercutter </a><li><a class=dropdown-item href=/spacewalk/elektronik-werkstatt/> Elektronik-Werkstatt </a><li><a class=dropdown-item href=/spacewalk/3d-lab/> 3D-Labor </a><li><a class=dropdown-item href=/spacewalk/schnittstelle/> Schnittstelle (Textilien) </a><li><a class=dropdown-item href=/spacewalk/radstelle/> Radstelle (Fahrrad) </a><li><a class=dropdown-item href=/spacewalk/holz-werkstatt/> Holz-Werkstatt </a><li><a class=dropdown-item href=/spacewalk/metall-werkstatt/> Metall-Werkstatt </a><li><a class=dropdown-item href=/spacewalk/foto-lab/> Foto-Labor </a><li><a class=dropdown-item href=/spacewalk/rem/> REM </a><li><a class=dropdown-item href=/spacewalk/kueche/> Küche </a><li><a class=dropdown-item href=/spacewalk/lounge/> Conference, Freifläche, Lounge </a></ul><li class="nav-item dropdown"><a class="text-white text-decoration-none d-block py-2 pe-3 dropdown-toggle" aria-expanded=false data-bs-toggle=dropdown href=# role=button> Bilder </a> <ul class=dropdown-menu><li><a class=dropdown-item href=/images/panorama/> Virtual Tour </a><li><a class=dropdown-item href=/images/albums/> Fotoalben </a><li><a class=dropdown-item href=/images/ifs/> Images From Space </a></ul><li class=nav-item><a class="text-white text-decoration-none d-block py-2 pe-3" aria-expanded=false href=https://ktt-ol.github.io/blog/ role=button> Blog </a><li class=nav-item><a class="text-white text-decoration-none d-block py-2 pe-3" aria-expanded=false href=https://ktt-ol.github.io/calendar/ role=button> Termine </a><li class=nav-item><a class="text-white text-decoration-none d-block py-2 pe-3" aria-expanded=false href=https://ktt-ol.github.io/contact/ role=button> Kontakt </a><li class=nav-item><a class="text-white text-decoration-none d-block py-2 pe-3" aria-expanded=false href=https://ktt-ol.github.io/contact/#anreise role=button> Anreise </a></ul><ul class="navbar-nav navbar-right"><li class="nav-item dropdown"><a class="text-white text-decoration-none d-block py-2 pe-3 dropdown-toggle" aria-expanded=false data-bs-toggle=dropdown href=# role=button>  <svg class="bi bi-translate" viewbox="0 0 16 16" fill=currentColor height=16 width=16 xmlns=http://www.w3.org/2000/svg><path d="M4.545 6.714 4.11 8H3l1.862-5h1.284L8 8H6.833l-.435-1.286zm1.634-.736L5.5 3.956h-.049l-.679 2.022z"></path><path d="M0 2a2 2 0 0 1 2-2h7a2 2 0 0 1 2 2v3h3a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-3H2a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zm7.138 9.995q.289.451.63.846c-.748.575-1.673 1.001-2.768 1.292.178.217.451.635.555.867 1.125-.359 2.08-.844 2.886-1.494.777.665 1.739 1.165 2.93 1.472.133-.254.414-.673.629-.89-1.125-.253-2.057-.694-2.82-1.284.681-.747 1.222-1.651 1.621-2.757H14V8h-3v1.047h.765c-.318.844-.74 1.546-1.272 2.13a6 6 0 0 1-.415-.492 2 2 0 0 1-.94.31"></path></svg> </a> <ul class=dropdown-menu><li><a class=dropdown-item href=/blog/2016/acs> <img alt="german flag" class=me-1 src=https://ktt-ol.github.io/media/img/lang/de.png> Deutsch </a><li><a class=dropdown-item href=/en/blog/2016/acs> <img alt="english flag" class=me-1 src=https://ktt-ol.github.io/media/img/lang/en.png> Englisch </a></ul></ul></div></div></nav></div></header><main class=row id=content><div class=col-lg-9><h1 class="d-flex justify-content-between">Hackspace Access Control System <span class=text-end> <a class="badge text-bg-light" rel="nofollow noreferrer noopener" href=https://github.com/ktt-ol/access-control-system/ target=_blank> Repository </a> </span></h1><div class=main-content><p><img alt="Hacs logo" decoding=async loading=lazy src=/media/blog/2016/acs/hacs-logo.svg><p>While the status-switch is nice, it does not help to actually get into a hackspace. For this you need some keys and with multiple people having access rights having a single key is quite annoying. While there are a few simple solutions they usually lack some desired features. Thus we decided to implement a digital access control system, that can open our doors.<h2>Hardware</h2><p>As visible in the <a href=/map.mainframe.io>Space Map</a>, there are multiple ways to get into our Hackspace. Let’s have a look at the main entrance for now. The first door is the building’s entrance downstairs. This is not yet handled by the access control system, since its not exclusively used by us and needs agreements with different people first.<p>Then in the second floor (not counting the ground level - the building has no first floor) there is a glass-door from the staircase to our front corridor. This door has been armed with a few sensors by us, a door opener as well as a bell button next to it. The corridor is also used as emergency exit from our neighbours, so the glass-door contains a panic lock. It will automatically unlock the door if somebody uses the inner doorhandle. We notice any door opening by the door using a small reed-contact and always know if the door is locked using a bolt-switch. This information is fed into our <a href=//grafana.mainframe.io>Grafana</a> instance. If the door is not locked, it can be opened using a door opener (buzzer). Our access control system opens the door, if the bell button is pressed and the space is not closed. If it is closed, the bell button rings the bell instead. A small ws2812b LED inside of the bell button gives a hint about the current space status.<p>Next, there are two doors going from the corridor onto our main area. One going straight to the main area (AKA main-door) and one going via our conference room. The one going via the conference room is not yet upgraded, but the main-door has the same sensors as the glass-door, as well as the door opener and the bell button. Additionally it already had a keypad, which has been integrated into our access control system. This door also has a motor-lock (using an ABUS CFA1000).<p>Historically we used the status-switch, to change the space-status and a normal key to (un)lock the door. We are currently migrating away from the switch to a SSH based setup (and an Android app using our custom ssh interface) for changing the space-status. Then the door-lock will automatically (un)lock the space based upon the status provided via ssh. Once unlocked the door can be opened by our members using the keypad. Guests can ring the bell using the bell button instead. There is also an “Open House” mode, which is called “open+” by us. In this mode the bell button directly opens the door.<p>Below you can see a diagram of all hardware implementing the above. The green boxes are related to the glass-door and the blue boxes to the main-door. The orange boxes relate to hardware on our main area. The red dashed line is a ws2812b bus provided by an attiny85 and provides status indications. The green dashed lines are GPIO handles. Note that those are slightly simplified, as they sometimes contain pull-ups/pull-downs, logic-level converters or even relays to control the actual hardware.<p><img alt="Hardware Interconnection Overview" decoding=async loading=lazy src=/media/blog/2016/acs/hardware-overview.svg><h2 id=-1>Sofware</h2><p>The handling of the GPIOs and other hardware components happens on a Raspberry Pi 2 running a (minimal) Debian and Debian kernel. The <a rel="noopener nofollow noreferrer" href=https://en.wikipedia.org/wiki/Device_tree target=_blank>device tree</a> has been modificated slightly, so that the kernel knows about the mcp23017 port expanders and the keypad.<p>Since there is no userspace support for DT overlays in the mainline/Debian kernel so far; the standard DT blob must be modified instead. The one provided by Debian’s kernel package can be made readable again using <code>dtc -I dtb -O dts -o rpi.dts /path/to/rpi.dtb</code>. Then we add our custom modifications from <a href=/media/blog/2016/acs/devicetree-additions.dts>devicetree-additions.dts</a>.<p>With that done the software from the github repository linked above can be used. It comes with multiple daemons:<table><thead><tr><th>Binary<th>Description<tbody><tr><td>acs-abus-cfa1000-sensor<td>Send Bolt State of Abus CFA1000 to MQTT<tr><td>acs-abus-cfa1000-setup<td>Setup Abus CFA1000 (use after power loss)<tr><td>acs-gio-actor<td>Make output GPIO accessible from MQTT<tr><td>acs-gpio-sensor<td>Make input GPIO accessible from MQTT<tr><td>acs-i2c-led<td>Control LEDs connected to the attiny85<tr><td>acs-keyboard<td>Handle for keypad device<tr><td>acs-status-display<td>Handler for usb-serial display<tr><td>acs-switch<td>Handler for status switch<tr><td>acs-keyholder-interface<td>SSH interface<tr><td>acs-mqtt-fwd<td>Forward SSH data to MQTT<tr><td>acs-doorctrl<td>Control ABUS CFA1000 based from SSH data<tr><td>acs-main-door<td>Handler for main-door bell-button<tr><td>acs-glass-door<td>Handler for glass-door bell-button</table><h2 id=-2>SSH Setup</h2><p>On the RPi a new system user is created e.g. “keyholder”. For this user the login shell is set to “acs-keyholder-interface”, which runs with suid bit. It only supports a few commands (actually just “set-status” and “set-next-status” at the moment). Apart from that you provide a ~/.ssh/authorized_keys in the usual format. Last but not least the user information must be added to the user DB (usually <code>/var/lib/acs.db</code>).<p>If you now try to set the state using <code>ssh keyholder@access-control-system set-status open+ "Open 4 all!"</code> the system will check the fingerprint of the key, that did the ssh login and infer the user information from that generating a few simple files in <code>/run/acs-state</code>. These files are interpreted by acs-mqtt-fwd and acs-doorctrl respectively.<p>If the deprecated status switch is used to change the status, the files in <code>/run/acs-state</code> are deleted.</div></div><div class=col-lg-3><div class="mb-auto d-flex flex-column"><div class="d-flex flex-column"><h3><a class=ms-2 href=//status.mainframe.io> Status </a></h3><div class=px-2 id=space-status style=font-size:.9em><a class="d-flex p-0 flex-column text-decoration-none btn btn-white rounded-0 text-dark d-none border-bottom border-black" href=//status.mainframe.io id=status-template role=button> <div class="text-start ps-1 fw-bold lh-sm" id=status-name-template>Template:</div> <div class="text-end pe-1 lh-sm" id=status-text-unknown-template>???</div> <div class="text-end pe-1 lh-sm d-none" id=status-text-closed-template>Geschlossen</div> <div class="text-end pe-1 lh-sm d-none" id=status-text-closing-template>Schließt bald</div> <div class="text-end pe-1 lh-sm d-none" id=status-text-open-template>Geöffnet</div> <div class="text-end pe-1 lh-sm d-none" id=status-text-member-template>Geschlossen (Member Only)</div> <div class="text-end pe-1 lh-sm d-none" id=status-text-keyholder-template>Geschlossen (Keyholder Only)</div> </a></div></div><div class="d-flex mt-2 flex-column"><h3><a class=ms-2 href=https://ktt-ol.github.io/calendar/> Termine </a></h3><div class=px-2 style=font-size:.9em></div></div></div></div></main><footer class="border-top pt-2 mt-5 row" id=footer><div class=col><p style=text-align:center>© 2025 <a href=https://ktt-ol.github.io>Kreativität trifft Technik</a> | License: <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC-BY-SA 4.0</a> | <a href=https://ktt-ol.github.io/impressum/>Impressum</a></div></footer></div><script async integrity=sha384-1G/Ktf1eAP9M5l65w5viov46isK3CQ2f1pML7ZTSpgeAK0sz2zkDxQUwmixq1jrU src=https://ktt-ol.github.io/js/site.js type=module></script><script async integrity=sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q src=https://ktt-ol.github.io/js/bootstrap.bundle.min.js type=module></script><script>const ROOMS = [{"name":"spaceOpen","title":{"de":"Hackspace","en":"Hackspace"}},{"name":"machining","title":{"de":"Zerspanung","en":"Machining"}},{"name":"woodworking","title":{"de":"Holzwerkstatt","en":"Woodworking"}},{"name":"lab3dOpen","title":{"de":"3D Lab","en":"3D Lab"}},{"name":"radstelleOpen","title":{"de":"Radstelle","en":"Cycling"}}];</script>